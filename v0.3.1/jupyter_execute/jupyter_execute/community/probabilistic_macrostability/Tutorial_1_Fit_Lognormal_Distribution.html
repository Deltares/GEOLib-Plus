
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Tutorial 1: Deriving Lognormal statistics from measurements &#8212; geolib+ 0.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="tutorial-1-deriving-lognormal-statistics-from-measurements">
<h1>Tutorial 1: Deriving Lognormal statistics from measurements<a class="headerlink" href="#tutorial-1-deriving-lognormal-statistics-from-measurements" title="Permalink to this heading">¶</a></h1>
<p>This tutorial shows how to derive parameters of the Lognormal distribution using the Method of Moments, and by doing statistics on the logarithm of the values $ln(x)$. The tutorial covers the calculation of characteristic values, inclusing statistical uncertainty and (spatial) averaging. The following steps are discussed:</p>
<ol class="arabic simple">
<li><p>Importing the dataset, interpreting the data</p></li>
<li><p>Determine the sample mean and standard deviation</p></li>
<li><p>Determine the Lognormal distribution parameter using the Method of Moments</p></li>
<li><p>Determine the characteristic values</p></li>
<li><p>Determine the inputs for D-Stability, taking into account the statistical uncertainty</p></li>
</ol>
</section>
<section id="step-1-importing-the-dataset-and-interpreting-the-data">
<h1>Step 1: Importing the dataset, and interpreting the data.<a class="headerlink" href="#step-1-importing-the-dataset-and-interpreting-the-data" title="Permalink to this heading">¶</a></h1>
<p>In the next cells, we import the python packages necessary to run this tutorial. If the packages are not available, install them in your Python environment using <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">&lt;package_name&gt;</span> </code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>Import the data using the Pandas package, and show the first 5 entries of the dataframe with the measurements</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The headers are automatically taken as column names.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../_static/input_volumetricweight_testresults.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># The headers are automatically taken as column names.</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../_static/input_volumetricweight_testresults.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">df</span>

<span class="nn">File D:\buildAgent\work\ca49001b42bc6873\geoLibPlusCondaEnv\lib\site-packages\pandas\io\parsers\readers.py:948,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">935</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">936</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">944</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">945</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">946</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">948</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File D:\buildAgent\work\ca49001b42bc6873\geoLibPlusCondaEnv\lib\site-packages\pandas\io\parsers\readers.py:611,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">608</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">610</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">611</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">613</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">614</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File D:\buildAgent\work\ca49001b42bc6873\geoLibPlusCondaEnv\lib\site-packages\pandas\io\parsers\readers.py:1448,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1445</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1447</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1448</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File D:\buildAgent\work\ca49001b42bc6873\geoLibPlusCondaEnv\lib\site-packages\pandas\io\parsers\readers.py:1705,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1703</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1704</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1705</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1706</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1707</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1708</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1709</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1710</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1711</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1712</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1713</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1714</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1715</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1716</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File D:\buildAgent\work\ca49001b42bc6873\geoLibPlusCondaEnv\lib\site-packages\pandas\io\common.py:863,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">859</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">861</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">862</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">863</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">864</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">865</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">866</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">867</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;../../_static/input_volumetricweight_testresults.txt&#39;
</pre></div>
</div>
</div>
</div>
<p>Get our measurements in a numpy array <code class="docutils literal notranslate"><span class="pre">x</span></code>, and plot the histogram of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;VolWeight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/795a5854f9bb4f983f6608580d70da84230eb638f1294e9a687a51fe161fe1ee.png" src="../../../../_images/795a5854f9bb4f983f6608580d70da84230eb638f1294e9a687a51fe161fe1ee.png" />
</div>
</div>
<section id="step-2-sample-mean-and-sample-standard-deviation-of-the-data-set">
<h2>Step 2: Sample mean and sample standard deviation of the data set<a class="headerlink" href="#step-2-sample-mean-and-sample-standard-deviation-of-the-data-set" title="Permalink to this heading">¶</a></h2>
<section id="step-2a-calculate-the-mean-and-standard-deviation-of-the-real-values">
<h3>Step 2a: Calculate the mean and standard deviation of the ‘real’ values<a class="headerlink" href="#step-2a-calculate-the-mean-and-standard-deviation-of-the-real-values" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First set up a function to calculate.</span>
<span class="k">def</span> <span class="nf">calculate_mean_and_std</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">sample_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">sample_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cov</span> <span class="o">=</span> <span class="n">sample_std</span><span class="o">/</span><span class="n">sample_mean</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample mean = </span><span class="se">\t\t\t</span><span class="si">%0.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">sample_mean</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample std = </span><span class="se">\t\t\t</span><span class="si">%0.3f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">sample_std</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coefficient of variation cov = </span><span class="se">\t</span><span class="si">%0.3f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">cov</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">sample_mean</span><span class="p">,</span> <span class="n">sample_std</span>

<span class="c1"># Now calculate the mean and std with that function</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean and standard deviation of x&#39;</span><span class="p">)</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">calculate_mean_and_std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean and standard deviation of x
Sample mean = 			18.46
Sample std = 			1.701
Coefficient of variation cov = 	0.092
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2b-calculate-the-mean-and-standard-deviation-of-the-logarithmic-values">
<h3>Step 2b: Calculate the mean and standard deviation of the logarithmic values<a class="headerlink" href="#step-2b-calculate-the-mean-and-standard-deviation-of-the-logarithmic-values" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we do almost exactly the same, however, we </span>
<span class="c1"># calculate the mean and std of log(x) </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean and standard deviation of ln(x)&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">calculate_mean_and_std</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean and standard deviation of ln(x)
Sample mean = 			2.91
Sample std = 			0.090
Coefficient of variation cov = 	0.031
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="step-3-fitted-lognormal-distribution-using-method-of-moments-mom">
<h2>Step 3: Fitted Lognormal Distribution using method of moments (MoM)<a class="headerlink" href="#step-3-fitted-lognormal-distribution-using-method-of-moments-mom" title="Permalink to this heading">¶</a></h2>
<p>First we introduce two functions.</p>
<ol class="arabic simple">
<li><p>The first <code class="docutils literal notranslate"><span class="pre">lognormal_parameters_from_mu_sigma(mu_x,</span> <span class="pre">sigma_x,</span> <span class="pre">shift)</span></code> transforms the mean and standard deviation of x (i.e. the first and second moment, respectively) into the parameters of the Lognormal distribution.</p></li>
<li><p>The second <code class="docutils literal notranslate"><span class="pre">mu_sigma_from_lognormal_parameters(mu_y,</span> <span class="pre">sigma_y,</span> <span class="pre">shift)</span></code> does the exact opposite: it transforms the parameters of the Lognormal distribution into the mean and standard deviation of x.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lognormal_parameters_from_mu_sigma</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convention: a Lognormal distribution of X, </span>
<span class="sd">    means that Y = ln(X) is normally distributed. </span>
<span class="sd">    INPUT</span>
<span class="sd">        mu = mean(X)</span>
<span class="sd">        sigma = mean(X)</span>
<span class="sd">        shift = default 0</span>
<span class="sd">    OUTPUT</span>
<span class="sd">        m = mean(Y)</span>
<span class="sd">        s = stdev(Y)</span>
<span class="sd">        shift </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">shift</span>

<span class="k">def</span> <span class="nf">mu_sigma_from_lognormal_parameters</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convention: a Lognormal distribution of X, </span>
<span class="sd">    means that Y = ln(X) is normally distributed. </span>
<span class="sd">    INPUT</span>
<span class="sd">        m = mean(Y)</span>
<span class="sd">        s = std(Y)</span>
<span class="sd">        shift = default 0</span>
<span class="sd">    OUTPUT</span>
<span class="sd">        mu = mean(X)</span>
<span class="sd">        sigma = mean(X)</span>
<span class="sd">        shift = default 0 </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">shift</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">mu</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">shift</span>
</pre></div>
</div>
</div>
</div>
<p>To transform the mean and standard deviation (the first and second moment, respectively) into the parameters of the Lognormal distribution, we call the function. Then we print the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assume the lognormal is not shifted (shift=0)</span>
<span class="n">shift</span><span class="o">=</span><span class="mi">0</span>
<span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="n">lognormal_parameters_from_mu_sigma</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Location, scale, and shift parameters of the</span><span class="se">\</span>
<span class="s1">Lognormal distribution (Y=log(X)) are: </span><span class="se">\n\</span>
<span class="s1">m_Y = </span><span class="se">\t\t</span><span class="si">%0.2f</span><span class="se">\n\</span>
<span class="s1">s_Y = </span><span class="se">\t\t</span><span class="si">%0.3f</span><span class="se">\n\</span>
<span class="s1">shift_Y =</span><span class="se">\t</span><span class="si">%0.1f</span><span class="s1"> &#39;</span><span class="o">%</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">shift</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Location, scale, and shift parameters of theLognormal distribution (Y=log(X)) are: 
m_Y = 		2.91
s_Y = 		0.092
shift_Y =	0.0 
</pre></div>
</div>
</div>
</div>
<p>The next step is to check the other formula for ‘the other way around’ (parameters of the Lognormal distribution -&gt; mean and standard deviation).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assume the lognormal is not shifted (shift=0)</span>
<span class="n">shift</span><span class="o">=</span><span class="mi">0</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="n">mu_sigma_from_lognormal_parameters</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">shift</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean, standard deviation, and shift parameters of the</span><span class="se">\</span>
<span class="s1">Lognormal distribution are:</span><span class="se">\n\</span>
<span class="s1">mu_X = </span><span class="se">\t\t</span><span class="si">%0.2f</span><span class="se">\n\</span>
<span class="s1">sigma_X = </span><span class="se">\t</span><span class="si">%0.3f</span><span class="se">\n\</span>
<span class="s1">shift_X =</span><span class="se">\t</span><span class="si">%0.1f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">shift</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean, standard deviation, and shift parameters of theLognormal distribution are:
mu_X = 		18.46
sigma_X = 	1.701
shift_X =	0.0 
</pre></div>
</div>
</div>
</div>
<section id="step-3c-visual-inspection-of-the-results">
<h3>Step 3c: Visual inspection of the results<a class="headerlink" href="#step-3c-visual-inspection-of-the-results" title="Permalink to this heading">¶</a></h3>
<p>Now we can visulize the results. We first set up two functions for drawing the pdf of a normal and a lognormal. Then we call this function to make the plots we want.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First set up </span>
<span class="k">def</span> <span class="nf">plot_pdf_normal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate the pdf values using the norm.pdf function.</span>
<span class="sd">    Note that python uses the following terminology:</span>
<span class="sd">      location (loc) = mean value</span>
<span class="sd">      scale (scale) = standard deviation</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">pdf_values</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">pdf_values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PDF normal distribution&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Probability density (pdf)&#39;</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_pdf_lognormal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate the pdf values using the lognorm.pdf function.</span>
<span class="sd">    Note that python uses the following terminology:</span>
<span class="sd">      loc (location) = shift</span>
<span class="sd">      scale (scale) = median value (where cdf=0.5 ) -&gt; exp(m)</span>
<span class="sd">      s (standard deviation) = s</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">pdf_values</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">pdf_values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PDF lognormal distribution &#39;</span><span class="o">+</span><span class="n">label</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Probability density (pdf)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting the histogram of the data </span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>

<span class="c1"># Set up an x range for plotting</span>
<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

<span class="c1"># Plot the pdf of the normal and lognormal distribution for </span>
<span class="c1"># the xrange, using the above function.</span>
<span class="n">plot_pdf_normal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="n">plot_pdf_lognormal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/8e6b59a0ac612c7c668fac01c90d7e883906aab6e13bafe0c566f42c3086b832.png" src="../../../../_images/8e6b59a0ac612c7c668fac01c90d7e883906aab6e13bafe0c566f42c3086b832.png" />
</div>
</div>
<section id="optional-step-3d-derive-parameters-for-a-shifted-lognormal-distribution-with-all-values-shifted-to-14">
<h4>Optional step 3d: Derive parameters for a shifted Lognormal distribution, with all values shifted to 14<a class="headerlink" href="#optional-step-3d-derive-parameters-for-a-shifted-lognormal-distribution-with-all-values-shifted-to-14" title="Permalink to this heading">¶</a></h4>
<p>Note: this is an advanced step to show how a (manually shifted) lognormal distribution could be derived. To this end, we first shift all our data points ‘to the left’ with a value of 14 (assuming 14 is some kind of physical lower limit for this parameter). Then we derive the statistics for the lognormal parameter, and parse the shift=14 parameter to the plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We assume 14 is a physical lower limit for our volumetric weight parameter</span>
<span class="n">shift</span> <span class="o">=</span> <span class="mi">14</span>
<span class="c1"># Shift our measurements and derive the lognormal statistics. </span>
<span class="n">m_</span><span class="p">,</span> <span class="n">s_</span> <span class="o">=</span> <span class="n">calculate_mean_and_std</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span> <span class="p">)</span>

<span class="c1"># Plot the histogram and the pdf of a shifted Lognormal distribution</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>
<span class="n">plot_pdf_normal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="n">plot_pdf_lognormal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">m_</span><span class="p">,</span> <span class="n">s_</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample mean = 			1.42
Sample std = 			0.401
Coefficient of variation cov = 	0.282
</pre></div>
</div>
<img alt="../../../../_images/8b61cb2e04a34e8dc2f7dfb57bc15d31b06e8b62e967c105fc76fbdff1c432ee.png" src="../../../../_images/8b61cb2e04a34e8dc2f7dfb57bc15d31b06e8b62e967c105fc76fbdff1c432ee.png" />
</div>
</div>
</section>
</section>
</section>
<section id="step-4-characteristic-values">
<h2>Step 4: Characteristic values<a class="headerlink" href="#step-4-characteristic-values" title="Permalink to this heading">¶</a></h2>
<section id="step-4a-calculate-the-characteristic-value-with-the-student-t-factor">
<h3>Step 4a: Calculate the characteristic value with the Student-T factor.<a class="headerlink" href="#step-4a-calculate-the-characteristic-value-with-the-student-t-factor" title="Permalink to this heading">¶</a></h3>
<p>The number of measurements influences the statistical uncertainty of our estimated mean and standard deviation.
Therefore we apply the Student-T factor to account for statistical uncertainty due to a small number of samples. The characteristic value is calculated as follows:</p>
<p>$X_{char.,5%} = \exp( m + t_{5%,n-1} \cdot s \cdot \sqrt{ 1+ 1/n)}$ with $m$ and $s$ the lognormal parameters $\mu_Y$ and $\sigma_Y$.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">student_t_factor</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># df = degrees of freedom, which is n-1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t-value </span><span class="se">\t\t</span><span class="si">%0.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">student_t_factor</span><span class="p">))</span>

<span class="c1"># The 5%-characteristic value, using the t distributions, including</span>
<span class="c1"># the statistical uncertainty in the estimated mean (s/sqrt(n))</span>
<span class="c1"># Note the + sign before the student_t_factor, because student_t_factor is negative</span>
<span class="n">characteristic_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">student_t_factor</span> <span class="o">*</span> <span class="n">s</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n</span> <span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5p-char_value = </span><span class="se">\t</span><span class="si">%0.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">characteristic_value</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t-value 		-1.76
5p-char_value = 	15.55
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4b-calculate-the-characteristic-value-with-and-without-spatial-avaraging">
<h3>Step 4b: Calculate the characteristic value with and without spatial avaraging<a class="headerlink" href="#step-4b-calculate-the-characteristic-value-with-and-without-spatial-avaraging" title="Permalink to this heading">¶</a></h3>
<p>To account for spatial averaging the $\Gamma^2$ (variance reduction) factor is introduced into the equation</p>
<p>$X_{char.,5%} = \exp( m + t_{5%,n-1} \cdot s \cdot \sqrt{ \Gamma^2+ 1/n)}$ with $m$ and $s$ the lognormal parameters $\mu_Y$ and $\sigma_Y$.</p>
<p>Default assumptions on this factor are:</p>
<ul class="simple">
<li><p>$\Gamma^2 = 1.0$ : point values, no spatial averaging</p></li>
<li><p>$\Gamma^2 = 0.25$ : estimate of the regional variability, assumption half of the variance averages.</p></li>
<li><p>$\Gamma^2 = 0.0$ : spatial average, full spatial avaraging</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Allocate a list to store multiple outcomes</span>
<span class="n">stored_values</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Calculate the characteristic value for different choises of spatial averaging:</span>
<span class="n">gamma2_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">];</span>
<span class="k">for</span> <span class="n">gamma2</span> <span class="ow">in</span> <span class="n">gamma2_values</span><span class="p">:</span> 
    <span class="n">characteristic_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">student_t_factor</span> <span class="o">*</span> <span class="n">s</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">gamma2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n</span> <span class="p">)</span> <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gamma2: 5p-char_value = </span><span class="se">\t</span><span class="si">%0.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">characteristic_value</span><span class="p">))</span>
    <span class="n">stored_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">characteristic_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gamma2: 5p-char_value = 	15.55
gamma2: 5p-char_value = 	16.78
gamma2: 5p-char_value = 	17.63
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4c-visually-checking-the-results">
<h3>Step 4c: Visually checking the results<a class="headerlink" href="#step-4c-visually-checking-the-results" title="Permalink to this heading">¶</a></h3>
<p>The results are visually checked with the histogram and the pdf’s, showing the calculated characteristic value for the different asssumptions with a black vertical line and a colored dot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>
<span class="n">plot_pdf_normal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="n">plot_pdf_lognormal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="k">for</span> <span class="n">gamma2</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">gamma2_values</span><span class="p">,</span> <span class="n">stored_values</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\Gamma ^</span><span class="si">{2}</span><span class="s2">=</span><span class="si">%s</span><span class="s2">$&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">gamma2</span><span class="p">)</span> <span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.95</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/4537c07088cbf52d04b54ce1d311fd922d4232dc0d7af21a9d17fa55fd2bfbd5.png" src="../../../../_images/4537c07088cbf52d04b54ce1d311fd922d4232dc0d7af21a9d17fa55fd2bfbd5.png" />
</div>
</div>
</section>
</section>
<section id="step-5-get-the-inputs-for-d-stability-taking-into-account-the-statistical-uncertainty">
<h2>Step 5: Get the inputs for D-Stability, taking into account the statistical uncertainty<a class="headerlink" href="#step-5-get-the-inputs-for-d-stability-taking-into-account-the-statistical-uncertainty" title="Permalink to this heading">¶</a></h2>
<p>To correct the Lornormal standard deviation for the statistical uncertainty, we increase the std with a factor.</p>
<p>This factor equals $t_{5%,n-1}/z_{5%}$, where $z_{5%}=-1.645$.</p>
<section id="step-5a-for-the-uncertainty-in-the-point-values">
<h3>Step 5a: For the uncertainty in the point values<a class="headerlink" href="#step-5a-for-the-uncertainty-in-the-point-values" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correction_factor</span> <span class="o">=</span> <span class="n">student_t_factor</span> <span class="o">/</span> <span class="o">-</span><span class="mf">1.645</span> 
<span class="n">s_point_incl_stat</span> <span class="o">=</span>  <span class="n">s</span> <span class="o">*</span> <span class="n">correction_factor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>

<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="n">mu_sigma_from_lognormal_parameters</span><span class="p">(</span><span class="n">m</span><span class="p">,</span>
                                                      <span class="n">s_point_incl_stat</span><span class="p">,</span>
                                                      <span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean, standard deviation, and shift parameters of the</span><span class="se">\</span>
<span class="s1">Lognormal distribution </span><span class="se">\n\</span>
<span class="s1">For D-Stability input:</span><span class="se">\n\</span>
<span class="s1">mu_X = </span><span class="se">\t\t</span><span class="si">%0.2f</span><span class="se">\n\</span>
<span class="s1">sigma_X = </span><span class="se">\t</span><span class="si">%0.3f</span><span class="se">\n\</span>
<span class="s1">shift_X =</span><span class="se">\t</span><span class="si">%0.1f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">shift</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean, standard deviation, and shift parameters of theLognormal distribution 
For D-Stability input:
mu_X = 		18.47
sigma_X = 	1.883
shift_X =	0.0 
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5b-for-the-uncertainty-in-the-regional-average">
<h3>Step 5b: For the uncertainty in the regional average<a class="headerlink" href="#step-5b-for-the-uncertainty-in-the-regional-average" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_regional_average_incl_stat</span> <span class="o">=</span>  <span class="n">s</span> <span class="o">*</span> <span class="n">correction_factor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>

<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="n">mu_sigma_from_lognormal_parameters</span><span class="p">(</span><span class="n">m</span><span class="p">,</span>
                                                      <span class="n">s_regional_average_incl_stat</span><span class="p">,</span>
                                                      <span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean, standard deviation, and shift parameters of the</span><span class="se">\</span>
<span class="s1">Lognormal distribution </span><span class="se">\n\</span>
<span class="s1">For D-Stability input:</span><span class="se">\n\</span>
<span class="s1">mu_X = </span><span class="se">\t\t</span><span class="si">%0.2f</span><span class="se">\n\</span>
<span class="s1">sigma_X = </span><span class="se">\t</span><span class="si">%0.3f</span><span class="se">\n\</span>
<span class="s1">shift_X =</span><span class="se">\t</span><span class="si">%0.1f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">shift</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean, standard deviation, and shift parameters of theLognormal distribution 
For D-Stability input:
mu_X = 		18.41
sigma_X = 	1.021
shift_X =	0.0 
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5c-for-the-uncertainty-in-the-spatial-average">
<h3>Step 5c: For the uncertainty in the spatial average<a class="headerlink" href="#step-5c-for-the-uncertainty-in-the-spatial-average" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_spatial_average_incl_stat</span> <span class="o">=</span>  <span class="n">s</span> <span class="o">*</span> <span class="n">correction_factor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>

<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="n">mu_sigma_from_lognormal_parameters</span><span class="p">(</span><span class="n">m</span><span class="p">,</span>
                                                      <span class="n">s_spatial_average_incl_stat</span><span class="p">,</span>
                                                      <span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean, standard deviation, and shift parameters of the</span><span class="se">\</span>
<span class="s1">Lognormal distribution </span><span class="se">\n\</span>
<span class="s1">For D-Stability input:</span><span class="se">\n\</span>
<span class="s1">mu_X = </span><span class="se">\t\t</span><span class="si">%0.2f</span><span class="se">\n\</span>
<span class="s1">sigma_X = </span><span class="se">\t</span><span class="si">%0.3f</span><span class="se">\n\</span>
<span class="s1">shift_X =</span><span class="se">\t</span><span class="si">%0.1f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">shift</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean, standard deviation, and shift parameters of theLognormal distribution 
For D-Stability input:
mu_X = 		18.39
sigma_X = 	0.467
shift_X =	0.0 
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5d-visualize-the-results">
<h3>Step 5d: Visualize the results<a class="headerlink" href="#step-5d-visualize-the-results" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>
<span class="n">plot_pdf_lognormal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s_point_incl_stat</span><span class="p">,</span> 
                   <span class="n">label</span><span class="o">=</span><span class="s1">&#39;point statistics&#39;</span><span class="p">)</span>
<span class="n">plot_pdf_lognormal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s_regional_average_incl_stat</span><span class="p">,</span> 
                   <span class="n">label</span><span class="o">=</span><span class="s1">&#39;regional average&#39;</span><span class="p">)</span>
<span class="n">plot_pdf_lognormal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s_spatial_average_incl_stat</span><span class="p">,</span> 
                   <span class="n">label</span><span class="o">=</span><span class="s1">&#39;spatial average&#39;</span><span class="p">)</span>

<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:green&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">gamma2</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span> <span class="n">gamma2_values</span><span class="p">,</span> <span class="n">stored_values</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Characteristic value with $\Gamma ^</span><span class="si">{2}</span><span class="s2">=</span><span class="si">%s</span><span class="s2">$&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">gamma2</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/fe05b3eaf1db87d18765e0d4bf369d843cbc283c6ccb4038ea8b931ba8fd24df.png" src="../../../../_images/fe05b3eaf1db87d18765e0d4bf369d843cbc283c6ccb4038ea8b931ba8fd24df.png" />
</div>
</div>
</section>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../../index.html">
    <img class="logo" src="../../../../_static/geolib.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/install.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev/overview.html">Developer API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../community/tutorials/overview.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../community/probabilistic_macrostability/probabilistic_tutorials.html">Probabilistic Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../references.html">References</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://bitbucket.org/DeltaresGEO/geolib-plus/src">@Source code</a></li>
    
    <li class="toctree-l1"><a href="https://issuetracker.deltares.nl/secure/RapidBoard.jspa?projectKey=GEOLIB">@Issue Tracker</a></li>
    
    <li class="toctree-l1"><a href="https://publicwiki.deltares.nl/display/GEOLIB/GEOLIB+Home">@Project documentation</a></li>
    
    <li class="toctree-l1"><a href="https://publicwiki.deltares.nl/display/GEOLIB/GEOLib+releases">@Releases</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Deltares.
      
    </div>

    

    
  </body>
</html>